<!-- Hero -->
<mat-card class="pa-4 mb-4 ux-gradient-primary" appearance="outlined">
    <div class="header-content">
        <div class="title-row">
            <mat-icon class="mr-2">visibility</mat-icon>
            <span class="mat-headline-5 text-white font-weight-bold">View Customer</span>
        </div>
        <div class="subtitle-row text-white opacity-90">
            View the details of this customer.
        </div>
    </div>
</mat-card>

<!-- Main card -->
<mat-card class="ux-fade-in-up" style="animation-delay: 0.1s">
    <mat-card-header>
        <mat-card-title>Customer Details</mat-card-title>
    </mat-card-header>

    <mat-card-content>

        <!-- loading -->
        <ng-container *ngIf="model; else loadingTpl">

            <div *ngIf="serviceErrors.loadCustomerByIdError" class="error-container">
                {{ serviceErrors.loadCustomerByIdError }}
            </div>

            <div class="grid">

                <!-- Name -->
                <div class="grid-item">
                    <mat-form-field appearance="outline" class="w-100">
                        <mat-label>Name</mat-label>
                        <input matInput [value]="model!.name" readonly />
                        <button mat-icon-button matPrefix disabled>
                            <mat-icon>badge</mat-icon>
                        </button>
                    </mat-form-field>
                </div>

                <!-- Surname -->
                <div class="grid-item">
                    <mat-form-field appearance="outline" class="w-100">
                        <mat-label>Surname</mat-label>
                        <input matInput [value]="model!.surname" readonly />
                        <button mat-icon-button matPrefix disabled>
                            <mat-icon>person</mat-icon>
                        </button>
                    </mat-form-field>
                </div>

                <!-- Email -->
                <div class="grid-item">
                    <mat-form-field appearance="outline" class="w-100">
                        <mat-label>Email</mat-label>
                        <input matInput [value]="model!.email" readonly />
                        <button mat-icon-button matPrefix disabled>
                            <mat-icon>email</mat-icon>
                        </button>
                    </mat-form-field>
                </div>

                <!-- Category -->
                <div class="grid-item">
                    <mat-form-field appearance="outline" class="w-100">
                        <mat-label>Category</mat-label>
                        <mat-select [value]="model!.categoryId" disabled>
                            <mat-option *ngFor="let c of categoriesModels" [value]="c.id">
                                {{ c.name }}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>

                <!-- Sub Category -->
                <div class="grid-item">
                    <mat-form-field appearance="outline" class="w-100">
                        <mat-label>Sub Category</mat-label>
                        <mat-select [value]="model!.subCategoryId" disabled>
                            <mat-option *ngFor="let s of subCategoriesModels" [value]="s.id">
                                {{ s.name }}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>

                <!-- Active -->
                <div class="grid-item">
                    <mat-slide-toggle color="primary"
                                      [checked]="model!.isActive"
                                      disabled>
                        Active
                    </mat-slide-toggle>
                </div>

                <!-- Preferences -->
                <div class="grid-item-wide">
                    <mat-divider class="my-4"></mat-divider>
                    <h3 class="section-title">Preferences</h3>
                </div>

                <div class="grid-item">
                    <mat-slide-toggle color="primary"
                                      [checked]="model!.preference.newsLetter"
                                      disabled>
                        Subscribe to Newsletter
                    </mat-slide-toggle>
                </div>

                <div class="grid-item">
                    <mat-slide-toggle color="primary"
                                      [checked]="model!.preference.specials"
                                      disabled>
                        Receive Specials
                    </mat-slide-toggle>
                </div>

                <!-- Loyalty -->
                <div class="grid-item-wide">
                    <mat-divider class="my-4"></mat-divider>
                    <div class="loyalty-header">
                        <h3 class="section-title">Loyalty</h3>
                        <mat-slide-toggle color="primary"
                                          [checked]="hasLoyalty"
                                          disabled>
                            Has Loyalty
                        </mat-slide-toggle>
                    </div>
                </div>

                <ng-container *ngIf="hasLoyalty && model?.loyalty">
                    <div class="grid-item">
                        <mat-form-field appearance="outline" class="w-100">
                            <mat-label>Loyalty Number</mat-label>
                            <input matInput [value]="model!.loyalty!.loyaltyNo" readonly />
                            <button mat-icon-button matPrefix disabled>
                                <mat-icon>card_giftcard</mat-icon>
                            </button>
                        </mat-form-field>
                    </div>

                    <div class="grid-item">
                        <mat-form-field appearance="outline" class="w-100">
                            <mat-label>Points</mat-label>
                            <input matInput [value]="model!.loyalty!.points" readonly />
                        </mat-form-field>
                    </div>
                </ng-container>

                <!-- Addresses -->
                <div class="grid-item-wide">
                    <mat-divider class="my-4"></mat-divider>
                    <h3 class="section-title">Addresses</h3>
                </div>

                <ng-container *ngFor="let addr of model!.addresses; let i = index">
                    <div class="grid-item-wide address-block">
                        <div class="address-grid">

                            <div class="address-item">
                                <mat-form-field appearance="outline" class="w-100">
                                    <mat-label>Type</mat-label>
                                    <mat-select [value]="addr.addressType" disabled>
                                        <mat-option [value]="AddressType.Deliver">Delivery</mat-option>
                                        <mat-option [value]="AddressType.Billing">Billing</mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>

                            <div class="address-item">
                                <mat-form-field appearance="outline" class="w-100">
                                    <mat-label>Address line 1</mat-label>
                                    <input matInput [value]="addr.line1" readonly />
                                    <button mat-icon-button matPrefix disabled>
                                        <mat-icon>home</mat-icon>
                                    </button>
                                </mat-form-field>
                            </div>

                            <div class="address-item">
                                <mat-form-field appearance="outline" class="w-100">
                                    <mat-label>Address line 2</mat-label>
                                    <input matInput [value]="addr.line2" readonly />
                                    <button mat-icon-button matPrefix disabled>
                                        <mat-icon>home_work</mat-icon>
                                    </button>
                                </mat-form-field>
                            </div>

                            <div class="address-item">
                                <mat-form-field appearance="outline" class="w-100">
                                    <mat-label>City</mat-label>
                                    <input matInput [value]="addr.city" readonly />
                                    <button mat-icon-button matPrefix disabled>
                                        <mat-icon>location_city</mat-icon>
                                    </button>
                                </mat-form-field>
                            </div>

                            <div class="address-item">
                                <mat-form-field appearance="outline" class="w-100">
                                    <mat-label>Postal code</mat-label>
                                    <input matInput [value]="addr.postal" readonly />
                                    <button mat-icon-button matPrefix disabled>
                                        <mat-icon>local_post_office</mat-icon>
                                    </button>
                                </mat-form-field>
                            </div>

                        </div>
                    </div>
                </ng-container>

                <!-- Actions -->
                <div class="grid-item-wide actions-row">
                    <button mat-raised-button
                            color="accent"
                            type="button"
                            (click)="navigateToCustomerSearch()">
                        <mat-icon class="mr-1">arrow_back</mat-icon>
                        Back to list
                    </button>
                </div>

            </div>
        </ng-container>

        <ng-template #loadingTpl>
            <div class="loading-container">
                <mat-progress-spinner mode="indeterminate" diameter="40"></mat-progress-spinner>
                <div class="mt-2">Loading customer...</div>
            </div>
        </ng-template>
    </mat-card-content>
</mat-card>
