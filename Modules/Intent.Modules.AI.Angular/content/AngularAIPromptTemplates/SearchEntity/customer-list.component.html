<div class="customer-page">

  <mat-card class="customer-card">

    <mat-card-header>
      <mat-card-title>Customers</mat-card-title>
      <mat-card-subtitle>Manage and search your customers</mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>

      <!-- Top toolbar -->
      <div class="toolbar">

        <!-- Search -->
        <div class="toolbar-left">
          <mat-form-field appearance="outline" class="search-field">
            <mat-label>Search</mat-label>
            <input
              matInput
              placeholder="Name or surname"
              [(ngModel)]="customerSearchCriteria.searchTerm"
              (keyup.enter)="onSearch()"
            />
          </mat-form-field>

          <button
            mat-raised-button
            color="primary"
            (click)="onSearch()"
            class="search-button">
            Search
          </button>
        </div>

        <!-- Page size -->
        <div class="toolbar-right">
          <mat-form-field appearance="outline" class="page-size-field">
            <mat-label>Page size</mat-label>
            <mat-select
              [ngModel]="customerSearchCriteria.pageSize"
              (ngModelChange)="changePageSize($event)">
              <mat-option [value]="5">5</mat-option>
              <mat-option [value]="10">10</mat-option>
              <mat-option [value]="25">25</mat-option>
              <mat-option [value]="50">50</mat-option>
            </mat-select>
          </mat-form-field>
        </div>

      </div>

      <!-- Loading -->
      <div class="info" *ngIf="isLoading">
        Loading customers...
      </div>

      <!-- Error -->
      <div class="info error" *ngIf="!isLoading && serviceError">
        {{ serviceError }}
      </div>

      <!-- Table + pagination -->
      <ng-container *ngIf="!isLoading && customersModels as paged">

        <div class="summary">
          Showing {{ paged.data.length || 0 }} of {{ paged.totalCount }} customers
        </div>

        <!-- Material data table -->
        <table
          mat-table
          [dataSource]="paged.data"
          class="customers-table mat-elevation-z0"
          *ngIf="paged.data?.length; else noResults">

          <!-- ID Column -->
          <ng-container matColumnDef="id">
            <th mat-header-cell *matHeaderCellDef class="col-id">Id</th>
            <td mat-cell *matCellDef="let customer" class="col-id">
              {{ customer.id }}
            </td>
          </ng-container>

          <!-- Name Column -->
          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef class="col-name">Name</th>
            <td mat-cell *matCellDef="let customer" class="col-name">
              {{ customer.name }}
            </td>
          </ng-container>

          <!-- Surname Column -->
          <ng-container matColumnDef="surname">
            <th mat-header-cell *matHeaderCellDef class="col-surname">Surname</th>
            <td mat-cell *matCellDef="let customer" class="col-surname">
              {{ customer.surname }}
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

        </table>

        <ng-template #noResults>
          <div class="info">No customers found.</div>
        </ng-template>

        <!-- Pagination -->
        <div class="pagination" *ngIf="paged.pageCount > 1">
          <button
            mat-stroked-button
            color="primary"
            (click)="prevPage()"
            [disabled]="paged.pageNumber <= 1">
            Previous
          </button>

          <span class="page-info">
            Page {{ paged.pageNumber }} of {{ paged.pageCount }}
          </span>

          <button
            mat-stroked-button
            color="primary"
            (click)="nextPage()"
            [disabled]="paged.pageNumber >= paged.pageCount">
            Next
          </button>
        </div>

      </ng-container>

    </mat-card-content>

  </mat-card>

</div>
